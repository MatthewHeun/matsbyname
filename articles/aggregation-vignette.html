<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Aggregation in `matsbyname` • matsbyname</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregation in `matsbyname`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">matsbyname</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/matsbyname.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/about-vector-arguments.html">About Vector Arguments</a></li>
    <li><a class="dropdown-item" href="../articles/aggregation-vignette.html">Aggregation in `matsbyname`</a></li>
    <li><a class="dropdown-item" href="../articles/applybyname-vignette.html">Writing Custom Functions for `matsbyname`</a></li>
    <li><a class="dropdown-item" href="../articles/using-summarise-in-matsbyname.html">Using summarise in matsbyname</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MatthewHeun/matsbyname/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregation in `matsbyname`</h1>
                        <h4 data-toc-skip class="author">Matthew Kuperus
Heun</h4>
            
            <h4 data-toc-skip class="date">2025-05-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MatthewHeun/matsbyname/blob/master/vignettes/aggregation-vignette.Rmd" class="external-link"><code>vignettes/aggregation-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>aggregation-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>matsbyname</code> package provides several functions to
assist renaming and aggregating rows and columns of matrices. This
vignette shows how to use those functions.</p>
</div>
<div class="section level2">
<h2 id="aggregate_byname">
<code>aggregate_byname()</code><a class="anchor" aria-label="anchor" href="#aggregate_byname"></a>
</h2>
<p>By default
(<code>aggregation_map = NULL, margin = c(1,2), pattern_type = "exact"</code>),
<code><a href="../reference/aggregate_byname.html">aggregate_byname()</a></code> sums all rows and columns with the same
names, with the effect that remaining row and column names are
unique.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, </span>
<span>              <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, </span>
<span>              <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"duck"</span>, <span class="st">"duck"</span>, <span class="st">"goose"</span><span class="op">)</span>, </span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Paul"</span>, <span class="st">"George"</span>, <span class="st">"Ringo"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m</span></span>
<span><span class="co">#&gt;       John Paul George Ringo</span></span>
<span><span class="co">#&gt; duck     1    2      3     4</span></span>
<span><span class="co">#&gt; duck     5    6      7     8</span></span>
<span><span class="co">#&gt; goose    9   10     11    12</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;       George John Paul Ringo</span></span>
<span><span class="co">#&gt; duck      10    6    8    12</span></span>
<span><span class="co">#&gt; goose     11    9   10    12</span></span></code></pre></div>
<p>An <code>aggregation_map</code> can be provided, giving instructions
for rows or columns to aggregate and the names of the results.
<code>aggregation_map</code> should be a list of named strings. The
entries in the list give names of rows and columns to be aggregated. The
names of the list entries provide the names of the resulting
aggregates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;       John Paul George Ringo</span></span>
<span><span class="co">#&gt; duck     1    2      3     4</span></span>
<span><span class="co">#&gt; duck     5    6      7     8</span></span>
<span><span class="co">#&gt; goose    9   10     11    12</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span>, aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>birds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"duck"</span>, <span class="st">"goose"</span><span class="op">)</span>, </span>
<span>                                           guitarists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Paul"</span>, <span class="st">"George"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       guitarists Ringo</span></span>
<span><span class="co">#&gt; birds         54    24</span></span></code></pre></div>
<p>The margin over which the aggregation is to be performed is given by
the <code>margin</code> argument (<code>1</code> for rows,
<code>2</code> for columns).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;       John Paul George Ringo</span></span>
<span><span class="co">#&gt; duck     1    2      3     4</span></span>
<span><span class="co">#&gt; duck     5    6      7     8</span></span>
<span><span class="co">#&gt; goose    9   10     11    12</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span>, aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Beatles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Paul"</span>, <span class="st">"George"</span>, <span class="st">"Ringo"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Beatles</span></span>
<span><span class="co">#&gt; duck       10</span></span>
<span><span class="co">#&gt; duck       26</span></span>
<span><span class="co">#&gt; goose      42</span></span></code></pre></div>
<p><code>aggregation_map</code> can use regular expressions to identify
rows and columns to aggregate. Use <code>pattern_type = "literal"</code>
for this feature.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;       John Paul George Ringo</span></span>
<span><span class="co">#&gt; duck     1    2      3     4</span></span>
<span><span class="co">#&gt; duck     5    6      7     8</span></span>
<span><span class="co">#&gt; goose    9   10     11    12</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span>, aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>guitarists <span class="op">=</span> <span class="st">"^[JPG]"</span><span class="op">)</span>, </span>
<span>                 margin <span class="op">=</span> <span class="fl">2</span>, pattern_type <span class="op">=</span> <span class="st">"literal"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       guitarists Ringo</span></span>
<span><span class="co">#&gt; duck           6     4</span></span>
<span><span class="co">#&gt; duck          18     8</span></span>
<span><span class="co">#&gt; goose         30    12</span></span></code></pre></div>
<p>Note that rows and columns of aggregated matrices are always sorted
alphabetically.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span>
<span><span class="co">#&gt;       John Paul George Ringo</span></span>
<span><span class="co">#&gt; duck     1    2      3     4</span></span>
<span><span class="co">#&gt; duck     5    6      7     8</span></span>
<span><span class="co">#&gt; goose    9   10     11    12</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span>, aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>birds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"duck"</span>, <span class="st">"goose"</span><span class="op">)</span>, </span>
<span>                                           zguitarists <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Paul"</span>, <span class="st">"George"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Ringo zguitarists</span></span>
<span><span class="co">#&gt; birds    24          54</span></span></code></pre></div>
<p>It is an error to aggregate over a margin and leave identically named
rows or columns. The following function call will fail, because it
aggregates over both rows and columns (using the default
<code>margin = c(1,2)</code>) with nothing in the
<code>aggregation_map</code> to aggregate the two “duck” rows. The error
is informative: “Row names not unique. Duplicated row names are:
duck”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run</span></span>
<span><span class="fu"><a href="../reference/aggregate_byname.html">aggregate_byname</a></span><span class="op">(</span><span class="va">m</span>, aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Beatles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"John"</span>, <span class="st">"Paul"</span>, <span class="st">"George"</span>, <span class="st">"Ringo"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pieces">Pieces<a class="anchor" aria-label="anchor" href="#pieces"></a>
</h2>
<p>Commonly, row and column names are complex, carrying information in
prefixes, suffixes, and prepositional phrases. <code>matsbyname</code>
can aggregate by pieces of a name, using the <code>RCLabels</code>
package internally.</p>
<p>We’ll use the following matrix to demonstrate aggregating by pieces.
The rows and columns use different notations for names
(<code><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">RCLabels::bracket_notation</a></code> for rows and
<code><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">RCLabels::arrow_notation</a></code> for columns). The renaming and
aggregation capabilities of <code>matsbyname</code> still work, despite
the different notations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>,</span>
<span>                     <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Electricity [from Coal]"</span>, <span class="st">"Electricity [from Solar]"</span><span class="op">)</span>, </span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Motors -&gt; MD"</span>, <span class="st">"Cars -&gt; MD"</span>, <span class="st">"LED lamps -&gt; Light"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rename_to_piece_byname">
<code>rename_to_piece_byname()</code><a class="anchor" aria-label="anchor" href="#rename_to_piece_byname"></a>
</h2>
<p>Rows and columns can be renamed to their prefixes, suffixes, or
objects of prepositions, as demonstrated below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity            1          2                  3</span></span>
<span><span class="co">#&gt; Electricity            4          5                  6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;            Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; from Coal             1          2                  3</span></span>
<span><span class="co">#&gt; from Solar            4          5                  6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"from"</span>, margin <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;       Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Coal             1          2                  3</span></span>
<span><span class="co">#&gt; Solar            4          5                  6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;                          Motors Cars LED lamps</span></span>
<span><span class="co">#&gt; Electricity [from Coal]       1    2         3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]      4    5         6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;                          MD MD Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]   1  2     3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]  4  5     6</span></span></code></pre></div>
<p>In the examples above, renaming was accomplished by specifying the
<code>notation</code> for row or column names. But notation for row and
column labels can also be inferred via
<code><a href="https://matthewheun.github.io/RCLabels/reference/infer_notation.html" class="external-link">RCLabels::infer_notation()</a></code>. To infer notation when
renaming, set <code>inf_notation = TRUE</code> (the default) and give a
list of notations from which the notation can be inferred in the
<code>notation</code> argument. By default,
<code>notation = list(RCLabels::notations_list)</code>, because each
notation in <code><a href="https://matthewheun.github.io/RCLabels/reference/notations_list.html" class="external-link">RCLabels::notations_list</a></code> is a list itself.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity            1          2                  3</span></span>
<span><span class="co">#&gt; Electricity            4          5                  6</span></span></code></pre></div>
<p>When inferring notation, both margins can be renamed at the same
time, despite having different notations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors Cars LED lamps</span></span>
<span><span class="co">#&gt; Electricity      1    2         3</span></span>
<span><span class="co">#&gt; Electricity      4    5         6</span></span></code></pre></div>
<p>But <code>margin = list(c(1, 2))</code> is the default, so the code
can be simpler still.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors Cars LED lamps</span></span>
<span><span class="co">#&gt; Electricity      1    2         3</span></span>
<span><span class="co">#&gt; Electricity      4    5         6</span></span>
<span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span><span class="op">)</span></span>
<span><span class="co">#&gt;            MD MD Light</span></span>
<span><span class="co">#&gt; from Coal   1  2     3</span></span>
<span><span class="co">#&gt; from Solar  4  5     6</span></span></code></pre></div>
<p>Sometimes, a row or column label can match more than one possible
<code>notation</code>. In the above example, the row names are inferred
to conform to <code><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">RCLabels::bracket_notation</a></code>, the first match
in <code><a href="https://matthewheun.github.io/RCLabels/reference/notations_list.html" class="external-link">RCLabels::notations_list</a></code>.<br>
To specify the most-specific notation, set
<code>choose_most_specific = TRUE</code>. With
<code>choose_most_specific = TRUE</code>,
<code><a href="https://matthewheun.github.io/RCLabels/reference/from_notation.html" class="external-link">RCLabels::from_notation</a></code> is inferred, the suffixes are
different, and the renamed rows no longer contain “from”.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span>, choose_most_specific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       MD MD Light</span></span>
<span><span class="co">#&gt; Coal   1  2     3</span></span>
<span><span class="co">#&gt; Solar  4  5     6</span></span></code></pre></div>
<p>Note that “noun” is a synonym for “pref”.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"noun"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors Cars LED lamps</span></span>
<span><span class="co">#&gt; Electricity      1    2         3</span></span>
<span><span class="co">#&gt; Electricity      4    5         6</span></span></code></pre></div>
<p>The margin can be specified using row or column types from which the
numerical margin is inferred.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces_with_types</span> <span class="op">&lt;-</span> <span class="va">m_pieces</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/setrowtype.html">setrowtype</a></span><span class="op">(</span><span class="st">"Product"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/setcoltype.html">setcoltype</a></span><span class="op">(</span><span class="st">"Industry"</span><span class="op">)</span></span>
<span><span class="va">m_pieces_with_types</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">m_pieces_with_types</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span>piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="st">"Product"</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity            1          2                  3</span></span>
<span><span class="co">#&gt; Electricity            4          5                  6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">m_pieces_with_types</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span>piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="st">"Product"</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; from Coal             1          2                  3</span></span>
<span><span class="co">#&gt; from Solar            4          5                  6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">m_pieces_with_types</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span>piece <span class="op">=</span> <span class="st">"from"</span>, margin <span class="op">=</span> <span class="st">"Product"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Coal             1          2                  3</span></span>
<span><span class="co">#&gt; Solar            4          5                  6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">m_pieces_with_types</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span>piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="st">"Product"</span>, choose_most_specific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Coal             1          2                  3</span></span>
<span><span class="co">#&gt; Solar            4          5                  6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span>
<span><span class="va">m_pieces_with_types</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span>piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="st">"Industry"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          MD MD Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]   1  2     3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]  4  5     6</span></span>
<span><span class="co">#&gt; attr(,"rowtype")</span></span>
<span><span class="co">#&gt; [1] "Product"</span></span>
<span><span class="co">#&gt; attr(,"coltype")</span></span>
<span><span class="co">#&gt; [1] "Industry"</span></span></code></pre></div>
<p>Such renamings can be used for aggregations in which identically
named rows and columns are summed with <code><a href="../reference/aggregate_byname.html">aggregate_byname()</a></code>,
as demonstrated in section below.</p>
</div>
<div class="section level2">
<h2 id="aggregate_pieces_byname">
<code>aggregate_pieces_byname()</code><a class="anchor" aria-label="anchor" href="#aggregate_pieces_byname"></a>
</h2>
<p><code><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname()</a></code> bundles renaming and
aggregating tasks in a single function call. First, rows and/or columns
are renamed to the requested <code>piece</code> with the
<code><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname()</a></code> function. Then, aggregation is
performed via <code><a href="../reference/aggregate_byname.html">aggregate_byname()</a></code>, according to an
<code>aggregation_map</code> and the <code>pattern_type</code>, if
provided. With the default <code>aggregation_map = NULL</code>,
identically named pieces are aggregated together.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="co"># Aggregate Electricity in rows</span></span>
<span><span class="fu"><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"pref"</span>, margin <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity            5          7                  9</span></span>
<span><span class="co"># Aggregate useful energy types in columns</span></span>
<span><span class="fu"><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;                          Light MD</span></span>
<span><span class="co">#&gt; Electricity [from Coal]      3  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]     6  9</span></span></code></pre></div>
<p>When an <code>aggregation_map</code> is supplied, it applies to the
requested <code>piece</code>, not to the original row and/or column
names, as shown below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="co"># Aggregate by original energy type</span></span>
<span><span class="fu"><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"from"</span>, margin <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, </span>
<span>                        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`All sources` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coal"</span>, <span class="st">"Solar"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; All sources            5          7                  9</span></span>
<span></span>
<span><span class="fu"><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname</a></span><span class="op">(</span><span class="va">m_pieces</span>, piece <span class="op">=</span> <span class="st">"suff"</span>, margin <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                        notation <span class="op">=</span> <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span>, </span>
<span>                        aggregation_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`Transport` <span class="op">=</span> <span class="st">"MD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          Light Transport</span></span>
<span><span class="co">#&gt; Electricity [from Coal]      3         3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]     6         9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="aggregations-of-lists-and-data-frames-of-matrices">Aggregations of lists and data frames of matrices<a class="anchor" aria-label="anchor" href="#aggregations-of-lists-and-data-frames-of-matrices"></a>
</h2>
<p>The functions for renaming and aggregating can be used on lists and
data frames of matrices.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_pieces</span></span>
<span><span class="co">#&gt;                          Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]             1          2                  3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]            4          5                  6</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">m_pieces</span>, <span class="va">m_pieces</span><span class="op">)</span>, </span>
<span>                              piece <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pref"</span>, <span class="st">"suff"</span><span class="op">)</span>, </span>
<span>                              margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                              notation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/bracket_notation.html" class="external-link">bracket_notation</a></span>, </span>
<span>                                              <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;             Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Electricity            1          2                  3</span></span>
<span><span class="co">#&gt; Electricity            4          5                  6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;                          MD MD Light</span></span>
<span><span class="co">#&gt; Electricity [from Coal]   1  2     3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]  4  5     6</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>mats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">m_pieces</span>, <span class="va">m_pieces</span><span class="op">)</span>, </span>
<span>                     pce <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"suff"</span>, <span class="st">"pref"</span><span class="op">)</span>, </span>
<span>                     mgn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                     am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coal"</span>, <span class="st">"Solar"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Transport <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Motors"</span>, <span class="st">"Cars"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                     notn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/from_notation.html" class="external-link">from_notation</a></span>, <span class="fu">RCLabels</span><span class="fu">::</span><span class="va"><a href="https://matthewheun.github.io/RCLabels/reference/arrow_notation.html" class="external-link">arrow_notation</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   mats          pce       mgn       am               notn     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span> <span style="color: #949494;">&lt;chr [4]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span> <span style="color: #949494;">&lt;chr [4]&gt;</span></span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    aggregated <span class="op">=</span> <span class="fu"><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname</a></span><span class="op">(</span><span class="va">mats</span>, piece <span class="op">=</span> <span class="va">pce</span>, margin <span class="op">=</span> <span class="va">mgn</span>, </span>
<span>                                         aggregation_map <span class="op">=</span> <span class="va">am</span>, notation <span class="op">=</span> <span class="va">notn</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">res2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   mats          pce       mgn       am               notn      aggregated   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span> <span style="color: #949494;">&lt;chr [4]&gt;</span> <span style="color: #949494;">&lt;dbl [1 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> <span style="color: #949494;">&lt;named list [1]&gt;</span> <span style="color: #949494;">&lt;chr [4]&gt;</span> <span style="color: #949494;">&lt;dbl [2 × 2]&gt;</span></span></span>
<span><span class="va">res2</span><span class="op">$</span><span class="va">aggregated</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;         Motors -&gt; MD Cars -&gt; MD LED lamps -&gt; Light</span></span>
<span><span class="co">#&gt; Sources            5          7                  9</span></span>
<span><span class="va">res2</span><span class="op">$</span><span class="va">aggregated</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;                          LED lamps Transport</span></span>
<span><span class="co">#&gt; Electricity [from Coal]          3         3</span></span>
<span><span class="co">#&gt; Electricity [from Solar]         6         9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="aggregation-via-dplyrsummarise">Aggregation via <code>dplyr::summarise()</code><a class="anchor" aria-label="anchor" href="#aggregation-via-dplyrsummarise"></a>
</h2>
<p>Another type of aggregation is aided by the metadata columns of a
<code>matsindf</code>-style data frame. With single numbers, an
aggregation might look like this:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_simple</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">key</span>, <span class="op">~</span><span class="va">val</span>, </span>
<span>                             <span class="st">"A"</span>, <span class="fl">1</span>, </span>
<span>                             <span class="st">"A"</span>, <span class="fl">2</span>, </span>
<span>                             <span class="st">"B"</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">df_simple</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   key     val</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B        10</span></span>
<span><span class="va">df_simple</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   key     val</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B        10</span></span></code></pre></div>
<p>The same aggregation gives unexpected results with the default
arguments to the <code><a href="../reference/sum_byname.html">sum_byname()</a></code> function (specifically,
<code>.summarise = FALSE</code>), because <code><a href="../reference/sum_byname.html">sum_byname()</a></code> is
ambiguous for a data frame. Should the column be returned unchanged,
because each element is interpreted as the augend for a series of sums
that is missing addends, in which case the length of the returned object
is the same as the length of the input? Or should the list of objects be
summed down the column, returning only a single item (for each group),
as in the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code> function? (See the vignette
titled “Using summarise in matsbyname” for additional detail about this
ambiguity.) In the example below, the grouping has no effect on the
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> function, because
<code>sum_byname(.summarise = FALSE)</code> assumes that each row of
<code>val</code> is an augend without an addend.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2 rows are expected. 3 are observed.</span></span>
<span><span class="va">df_simple</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fu"><a href="../reference/sum_byname.html">sum_byname</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span><span class="co">#&gt; dplyr 1.1.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `reframe()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span><span class="co">#&gt;   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   key     val</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B        10</span></span></code></pre></div>
<p>To signal intention to summarise down the <code>val</code> column,
set <code>.summarise = TRUE</code> in the call to
<code><a href="../reference/sum_byname.html">sum_byname()</a></code>. Note that
<code>sum_byname(.summarise = TRUE)</code> <em>always</em> returns a
list column, because if the summarised column were to contain matrices,
it <em>must</em> be a list column.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">df_simple</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fu"><a href="../reference/sum_byname.html">sum_byname</a></span><span class="op">(</span><span class="va">val</span>, .summarise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># res$val is a list column.</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   key   val      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     <span style="color: #949494;">&lt;dbl [1]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     <span style="color: #949494;">&lt;dbl [1]&gt;</span></span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">val</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<p>The <code>.summarise = TRUE</code> argument works when there are
matrices in a <code>matsindf</code> data frame, too.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>,</span>
<span>              <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">23</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="st">"r2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c1"</span>, <span class="st">"c2"</span>, <span class="st">"c3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">m</span>, <span class="va">m</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">unexpected</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="../reference/sum_byname.html">sum_byname</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span><span class="co">#&gt; dplyr 1.1.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `reframe()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span><span class="co">#&gt;   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co"># 2 rows are expected. 3 are observed.</span></span>
<span><span class="va">unexpected</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   key   m            </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A     <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B     <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span></span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fu"><a href="../reference/sum_byname.html">sum_byname</a></span><span class="op">(</span><span class="va">m</span>, .summarise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   key   m            </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A     <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B     <span style="color: #949494;">&lt;dbl [2 × 3]&gt;</span></span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">m</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;    c1 c2 c3</span></span>
<span><span class="co">#&gt; r1 22 24 26</span></span>
<span><span class="co">#&gt; r2 42 44 46</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">m</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;    c1 c2 c3</span></span>
<span><span class="co">#&gt; r1 11 12 13</span></span>
<span><span class="co">#&gt; r2 21 22 23</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-aggregation-maps">Working with aggregation maps<a class="anchor" aria-label="anchor" href="#working-with-aggregation-maps"></a>
</h2>
<p>An aggregation map is defined to be a named list. But the source of
that named list is often a data frame in which many-to-one relationships
are defined. <code><a href="../reference/aggregation_map_helpers.html">agg_table_to_agg_map()</a></code> assists converting from
a two-column data frame to an aggregation map.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">member</span>, <span class="op">~</span><span class="va">role</span>, <span class="op">~</span><span class="va">band</span>, </span>
<span>                      <span class="st">"John"</span>, <span class="st">"guitarists"</span>, <span class="st">"The Beatles"</span>, </span>
<span>                      <span class="st">"Paul"</span>, <span class="st">"guitarists"</span>, <span class="st">"The Beatles"</span>, </span>
<span>                      <span class="st">"George"</span>, <span class="st">"guitarists"</span>, <span class="st">"The Beatles"</span>, </span>
<span>                      <span class="st">"Ringo"</span>, <span class="st">"drummers"</span>, <span class="st">"The Beatles"</span>, </span>
<span>                      <span class="st">"Mick"</span>, <span class="st">"singers"</span>, <span class="st">"Rolling Stones"</span>, </span>
<span>                      <span class="st">"Keith"</span>, <span class="st">"guitarists"</span>, <span class="st">"Rolling Stones"</span>, </span>
<span>                      <span class="st">"Ronnie"</span>, <span class="st">"guitarists"</span>, <span class="st">"Rolling Stones"</span>, </span>
<span>                      <span class="st">"Bill"</span>, <span class="st">"guitarists"</span>, <span class="st">"Rolling Stones"</span>, </span>
<span>                      <span class="st">"Charlie"</span>, <span class="st">"drummers"</span>, <span class="st">"Rolling Stones"</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 3</span></span></span>
<span><span class="co">#&gt;   member  role       band          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> John    guitarists The Beatles   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Paul    guitarists The Beatles   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> George  guitarists The Beatles   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Ringo   drummers   The Beatles   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Mick    singers    Rolling Stones</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Keith   guitarists Rolling Stones</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Ronnie  guitarists Rolling Stones</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> Bill    guitarists Rolling Stones</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> Charlie drummers   Rolling Stones</span></span>
<span><span class="va">bands_membs_agg_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregation_map_helpers.html">agg_table_to_agg_map</a></span><span class="op">(</span><span class="va">df</span>, few_colname <span class="op">=</span> <span class="st">"band"</span>, many_colname <span class="op">=</span> <span class="st">"member"</span><span class="op">)</span></span>
<span><span class="va">bands_membs_agg_map</span></span>
<span><span class="co">#&gt; $`Rolling Stones`</span></span>
<span><span class="co">#&gt; [1] "Mick"    "Keith"   "Ronnie"  "Bill"    "Charlie"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`The Beatles`</span></span>
<span><span class="co">#&gt; [1] "John"   "Paul"   "George" "Ringo"</span></span>
<span><span class="fu"><a href="../reference/aggregation_map_helpers.html">agg_table_to_agg_map</a></span><span class="op">(</span><span class="va">df</span>, few_colname <span class="op">=</span> <span class="st">"role"</span>, many_colname <span class="op">=</span> <span class="st">"member"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $drummers</span></span>
<span><span class="co">#&gt; [1] "Ringo"   "Charlie"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $guitarists</span></span>
<span><span class="co">#&gt; [1] "John"   "Paul"   "George" "Keith"  "Ronnie" "Bill"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $singers</span></span>
<span><span class="co">#&gt; [1] "Mick"</span></span></code></pre></div>
<p>In a similar manner, an aggregation map can be converted to a data
frame to assist with join operations with data frames.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aggregation_map_helpers.html">agg_map_to_agg_table</a></span><span class="op">(</span><span class="va">bands_membs_agg_map</span>, </span>
<span>                      few_colname <span class="op">=</span> <span class="st">"bands"</span>,</span>
<span>                      many_colname <span class="op">=</span> <span class="st">"members"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 2</span></span></span>
<span><span class="co">#&gt;   bands          members</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Rolling Stones Mick   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Rolling Stones Keith  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Rolling Stones Ronnie </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Rolling Stones Bill   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Rolling Stones Charlie</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> The Beatles    John   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> The Beatles    Paul   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> The Beatles    George </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> The Beatles    Ringo</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The <code>matsbyname</code> package simplifies aggregation of matrix
rows and columns based on row and column names or pieces of row and
column names. In particular the functions
<code><a href="../reference/aggregate_byname.html">aggregate_byname()</a></code>, <code><a href="../reference/rename_to_piece_byname.html">rename_to_piece_byname()</a></code>,
and <code><a href="../reference/aggregate_pieces_byname.html">aggregate_pieces_byname()</a></code> provide flexibility in how
renaming and aggregation can be accomplished. When working with
aggregation maps, the functions <code><a href="../reference/aggregation_map_helpers.html">agg_table_to_agg_map()</a></code> and
<code><a href="../reference/aggregation_map_helpers.html">agg_map_to_agg_table()</a></code> assist conversion from one data
shape to another.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
